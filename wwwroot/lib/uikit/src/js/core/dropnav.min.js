/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/uikit@3.16.12/src/js/core/dropnav.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{active}from"./drop";import Class from"../mixin/class";import Container from"../mixin/container";import{$,$$,addClass,after,attr,css,findIndex,getIndex,hasAttr,hasClass,height,includes,isRtl,matches,noop,observeResize,offset,once,parents,query,remove,selFocusable,toFloat,Transition,within}from"uikit-util";import{keyMap}from"../util/keys";export default{mixins:[Class,Container],props:{align:String,clsDrop:String,boundary:Boolean,dropbar:Boolean,dropbarAnchor:Boolean,duration:Number,mode:Boolean,offset:Boolean,stretch:Boolean,delayShow:Boolean,delayHide:Boolean,target:Boolean,targetX:Boolean,targetY:Boolean,animation:Boolean,animateOut:Boolean},data:{align:isRtl?"right":"left",clsDrop:"uk-dropdown",clsDropbar:"uk-dropnav-dropbar",boundary:!0,dropbar:!1,dropbarAnchor:!1,duration:200,container:!1,selNavItem:"> li > a, > ul > li > a"},computed:{dropbarAnchor:({dropbarAnchor:t},e)=>query(t,e)||e,dropbar({dropbar:t}){return t?(t=this._dropbar||query(t,this.$el)||$(`+ .${this.clsDropbar}`,this.$el))||(this._dropbar=$("<div></div>")):null},dropContainer(t,e){return this.container||e},dropdowns({clsDrop:t},e){const r=$$(`.${t}`,e);if(this.dropContainer!==e)for(const e of $$(`.${t}`,this.dropContainer)){const t=this.getDropdown(e)?.targetEl;!includes(r,e)&&t&&within(t,this.$el)&&r.push(e)}return r},items:({selNavItem:t},e)=>$$(t,e)},watch:{dropbar(t){addClass(t,"uk-dropbar","uk-dropbar-top",this.clsDropbar,`uk-${this.$options.name}-dropbar`)},dropdowns(t){this.$create("drop",t.filter((t=>!this.getDropdown(t))),{...this.$props,flip:!1,shift:!0,pos:`bottom-${this.align}`,boundary:!0===this.boundary?this.$el:this.boundary})},items(t){attr(t,"tabindex",-1),attr(t[0],"tabindex",0)}},disconnected(){remove(this._dropbar),delete this._dropbar},events:[{name:"mouseover focusin",delegate(){return this.selNavItem},handler({current:t,type:e}){const r=this.getActive();if(r&&includes(r.mode,"hover")&&r.targetEl&&!within(r.targetEl,t)&&!r.isDelaying&&r.hide(!1),"focusin"===e)for(const e of this.items)attr(e,"tabindex",t===e?0:-1)}},{name:"keydown",delegate(){return this.selNavItem},handler(t){const{current:e,keyCode:r}=t,o=this.getActive();r===keyMap.DOWN&&hasAttr(e,"aria-expanded")&&(t.preventDefault(),o&&o.targetEl===e?focusFirstFocusableElement(o.$el):(e.click(),once(this.dropContainer,"show",(({target:t})=>focusFirstFocusableElement(t))))),handleNavItemNavigation(t,this.items,o)}},{name:"keydown",el(){return this.dropContainer},delegate(){return`.${this.clsDrop}`},handler(t){const{current:e,keyCode:r}=t;if(!includes(this.dropdowns,e))return;const o=this.getActive();let a=-1;if(r===keyMap.HOME?a=0:r===keyMap.END?a="last":r===keyMap.UP?a="previous":r===keyMap.DOWN?a="next":r===keyMap.ESC&&o.targetEl?.focus(),~a){t.preventDefault();const r=$$(selFocusable,e);r[getIndex(a,r,findIndex(r,(t=>matches(t,":focus"))))].focus()}handleNavItemNavigation(t,this.items,o)}},{name:"mouseleave",el(){return this.dropbar},filter(){return this.dropbar},handler(){const t=this.getActive();t&&includes(t.mode,"hover")&&!this.dropdowns.some((t=>matches(t,":hover")))&&t.hide()}},{name:"beforeshow",el(){return this.dropContainer},filter(){return this.dropbar},handler({target:t}){this.isDropbarDrop(t)&&(this.dropbar.previousElementSibling!==this.dropbarAnchor&&after(this.dropbarAnchor,this.dropbar),addClass(t,`${this.clsDrop}-dropbar`))}},{name:"show",el(){return this.dropContainer},filter(){return this.dropbar},handler({target:t}){if(!this.isDropbarDrop(t))return;const e=this.getDropdown(t),r=()=>{const e=parents(t,`.${this.clsDrop}`).concat(t).map((t=>offset(t))),r=Math.min(...e.map((({top:t})=>t))),o=Math.max(...e.map((({bottom:t})=>t))),a=offset(this.dropbar);css(this.dropbar,"top",this.dropbar.offsetTop-(a.top-r)),this.transitionTo(o-r+toFloat(css(t,"marginBottom")),t)};this._observer=observeResize([e.$el,...e.target],r),r()}},{name:"beforehide",el(){return this.dropContainer},filter(){return this.dropbar},handler(t){const e=this.getActive();matches(this.dropbar,":hover")&&e.$el===t.target&&!this.items.some((t=>e.targetEl!==t&&matches(t,":focus")))&&t.preventDefault()}},{name:"hide",el(){return this.dropContainer},filter(){return this.dropbar},handler({target:t}){if(!this.isDropbarDrop(t))return;this._observer?.disconnect();const e=this.getActive();e&&e.$el!==t||this.transitionTo(0)}}],methods:{getActive(){return includes(this.dropdowns,active?.$el)&&active},async transitionTo(t,e){const{dropbar:r}=this,o=height(r);e=o<t&&e,await Transition.cancel([e,r]),css(e,"clipPath",`polygon(0 0,100% 0,100% ${o}px,0 ${o}px)`),height(r,o),await Promise.all([Transition.start(r,{height:t},this.duration),Transition.start(e,{clipPath:`polygon(0 0,100% 0,100% ${t}px,0 ${t}px)`},this.duration).finally((()=>css(e,{clipPath:""})))]).catch(noop)},getDropdown(t){return this.$getComponent(t,"drop")||this.$getComponent(t,"dropdown")},isDropbarDrop(t){return this.getDropdown(t)&&hasClass(t,this.clsDrop)}}};function handleNavItemNavigation(t,e,r){const{current:o,keyCode:a}=t;let s=-1;a===keyMap.HOME?s=0:a===keyMap.END?s="last":a===keyMap.LEFT?s="previous":a===keyMap.RIGHT?s="next":a===keyMap.TAB&&(r.targetEl?.focus(),r.hide?.(!1)),~s&&(t.preventDefault(),r.hide?.(!1),e[getIndex(s,e,e.indexOf(r.targetEl||o))].focus())}function focusFirstFocusableElement(t){$(":focus",t)||$(selFocusable,t)?.focus()}
//# sourceMappingURL=/sm/88ff6b24efd4b46e1027efe8321676f26e08ea26bc78c19b9345e9a0f82bc513.map