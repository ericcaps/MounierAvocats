/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/uikit@3.16.12/src/js/mixin/modal.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Class from"./class";import Container from"./container";import Togglable from"./togglable";import{$,addClass,append,attr,css,endsWith,includes,isFocusable,isSameSiteAnchor,last,matches,on,once,parent,pointerCancel,pointerDown,pointerUp,removeClass,toFloat,within}from"uikit-util";import{preventBackgroundScroll}from"./internal/scroll";const active=[];export default{mixins:[Class,Container,Togglable],props:{selPanel:String,selClose:String,escClose:Boolean,bgClose:Boolean,stack:Boolean,role:String},data:{cls:"uk-open",escClose:!0,bgClose:!0,overlay:!0,stack:!1,role:"dialog"},computed:{panel:({selPanel:e},t)=>$(e,t),transitionElement(){return this.panel},bgClose({bgClose:e}){return e&&this.panel}},connected(){attr(this.panel||this.$el,"role",this.role),this.overlay&&attr(this.panel||this.$el,"aria-modal",!0)},beforeDisconnect(){includes(active,this)&&this.toggleElement(this.$el,!1,!1)},events:[{name:"click",delegate(){return`${this.selClose},a[href*="#"]`},handler(e){const{current:t,defaultPrevented:s}=e,{hash:n}=t;!s&&n&&isSameSiteAnchor(t)&&!within(n,this.$el)&&$(n,document.body)?this.hide():matches(t,this.selClose)&&(e.preventDefault(),this.hide())}},{name:"toggle",self:!0,handler(e){e.defaultPrevented||(e.preventDefault(),this.isToggled()===includes(active,this)&&this.toggle())}},{name:"beforeshow",self:!0,handler(e){if(includes(active,this))return!1;!this.stack&&active.length?(Promise.all(active.map((e=>e.hide()))).then(this.show),e.preventDefault()):active.push(this)}},{name:"show",self:!0,handler(){this.stack&&css(this.$el,"zIndex",toFloat(css(this.$el,"zIndex"))+active.length);const e=[this.overlay&&preventBackgroundFocus(this),this.overlay&&preventBackgroundScroll(this.$el),this.bgClose&&listenForBackgroundClose(this),this.escClose&&listenForEscClose(this)];once(this.$el,"hidden",(()=>e.forEach((e=>e&&e()))),{self:!0}),addClass(document.documentElement,this.clsPage)}},{name:"shown",self:!0,handler(){isFocusable(this.$el)||attr(this.$el,"tabindex","-1"),matches(this.$el,":focus-within")||this.$el.focus()}},{name:"hidden",self:!0,handler(){includes(active,this)&&active.splice(active.indexOf(this),1),css(this.$el,"zIndex",""),active.some((e=>e.clsPage===this.clsPage))||removeClass(document.documentElement,this.clsPage)}}],methods:{toggle(){return this.isToggled()?this.hide():this.show()},show(){return this.container&&parent(this.$el)!==this.container?(append(this.container,this.$el),new Promise((e=>requestAnimationFrame((()=>this.show().then(e)))))):this.toggleElement(this.$el,!0,animate)},hide(){return this.toggleElement(this.$el,!1,animate)}}};function animate(e,t,{transitionElement:s,_toggle:n}){return new Promise(((i,o)=>once(e,"show hide",(()=>{e._reject?.(),e._reject=o,n(e,t);const l=once(s,"transitionstart",(()=>{once(s,"transitionend transitioncancel",i,{self:!0}),clearTimeout(a)}),{self:!0}),a=setTimeout((()=>{l(),i()}),toMs(css(s,"transitionDuration")))})))).then((()=>delete e._reject))}function toMs(e){return e?endsWith(e,"ms")?toFloat(e):1e3*toFloat(e):0}function preventBackgroundFocus(e){return on(document,"focusin",(t=>{last(active)!==e||within(t.target,e.$el)||e.$el.focus()}))}function listenForBackgroundClose(e){return on(document,pointerDown,(({target:t})=>{last(active)!==e||e.overlay&&!within(t,e.$el)||within(t,e.panel)||once(document,`${pointerUp} ${pointerCancel} scroll`,(({defaultPrevented:s,type:n,target:i})=>{s||n!==pointerUp||t!==i||e.hide()}),!0)}))}function listenForEscClose(e){return on(document,"keydown",(t=>{27===t.keyCode&&last(active)===e&&e.hide()}))}
//# sourceMappingURL=/sm/12778191b9a3ac15e7a3182cd85af3a3b6fcf586ef39707764936f63ea2be979.map